# PCG for Unity

## Houdini PCG 数据类型总结

### 1. Point（点）
- ​**作用**: 几何体的最小单位，存储空间坐标和属性。
- ​**属性特点**:
  - 每个点有独立属性（如位置`P`、速度`v`、颜色`Cd`）。
  - 可被多个图元（Primitive）共享。
- ​**应用场景**: 粒子系统、顶点动画、点云数据。

### 2. Primitive（图元）
- ​**作用**: 构成几何体的基本形状单元。
- ​**常见类型**:
  - 多边形（Polygon）、曲线（Curve）、NURBS曲面、体积（Volume）。
- ​**属性特点**:
  - 存储图元级别属性（如材质ID、面积）。
  - 依赖点和顶点（Vertex）构建形状。
- ​**应用场景**: 建模、材质分配、碰撞检测。

### 3. Detail（细节/全局属性）
- ​**作用**: 描述整个几何体的全局属性。
- ​**属性特点**:
  - 每个几何体仅有一组Detail属性。
  - 存储元数据（如包围盒尺寸、创建时间）。
- ​**应用场景**: 全局参数控制、元数据存储。

### 4. Vertex（顶点）
- ​**作用**: 连接点（Point）和图元（Primitive）的中间结构。
- ​**属性特点**:
  - 存储图元内点的附加属性（如UV坐标、顶点颜色）。
  - 每个顶点关联一个点，但属性独立。
- ​**应用场景**: UV贴图、细分曲面、硬边处理。

### 5. Volume（体积）
- ​**作用**: 表示3D体积数据（体素网格）。
- ​**属性特点**:
  - 存储体素值（如密度、温度）。
  - 支持稀疏存储（如VDB格式）。
- ​**应用场景**: 烟雾模拟、地形生成、医学成像。

---

### 对比总结
| 类型       | 作用域          | 属性存储方式             | 典型应用           |
|------------|----------------|--------------------------|--------------------|
| ​**Point**​  | 单个点         | 每个点独立属性           | 粒子位置、点云     |
| ​**Primitive**​ | 单个图元     | 每个图元独立属性         | 多边形材质、曲线半径 |
| ​**Detail**​ | 整个几何体     | 全局唯一属性             | 包围盒、作者信息   |
| ​**Vertex**​ | 图元内的顶点   | 每个顶点关联点的属性     | UV坐标、硬边标记   |
| ​**Volume**​ | 3D空间体素    | 体素网格中的标量/矢量场  | 烟雾密度、地形侵蚀 |


## Houdini HeightField 核心节点功能详解

### 一、地形生成与基础处理节点
#### 1. ​**HeightField**​  
- 核心生成节点，创建基础高度场平面，通过调整网格间距（Grid Spacing）控制分辨率[2,4](@ref)。  
- 支持同时生成高度层（Height Layer）和遮罩层（Mask Layer），后者用于限定其他节点的作用范围[2,8](@ref)。

#### 2. ​**HeightField Noise**​  
- 为地形添加垂直噪波细节，生成山峰、山谷等自然形态，支持多层级噪波叠加（低/中/高频细节）[3,5](@ref)。  
- 可通过`Element Size`参数调整山峰间距，`Amplitude`控制高度差[5,6](@ref)。

#### 3. ​**HeightField Layer**​  
- 类似Photoshop的图层混合，支持通过叠加、差值等模式融合多个高度场，常用于组合不同噪波或手动雕刻区域[4,8](@ref)。  
- 结合`Blend`参数（0-1范围）控制混合权重[4](@ref)。

---

### 二、侵蚀与细节增强节点
#### 1. ​**HeightField Erode**​  
- 核心侵蚀节点，模拟水流冲刷（Hydro Erode）和热风化（Thermal Erosion）：  
  - ​**水流侵蚀**：通过`Erodability`控制侵蚀强度，`Spread Iterations`调整河道分支复杂度[1,6](@ref)。  
  - ​**热侵蚀**：根据坡度角度（Cut Angle）解算碎石堆积，`Removal Rate`控制碎石保留比例[1,6](@ref)。  
- 输出多层数据：水流路径（Flow Layer）、沉积物（Sediment）、碎石层（Debris）等，用于材质制作[1,6](@ref)。

#### 2. ​**HeightField Distort by Noise/Layer**​  
- 通过噪波或矢量场扭曲地形，打破硬边，增加表面多样性[3,8](@ref)。  
- 支持`Simplex`噪波类型生成更自然的扭曲效果[5](@ref)。

---

### 三、遮罩处理与区域限定节点
#### 1. ​**HeightField Mask by Feature**​  
- 根据地形的坡度、高度等特征生成遮罩，例如仅对陡峭区域应用侵蚀[2,8](@ref)。  
- 支持动态调整`Slope Range`参数控制遮罩作用范围[4](@ref)。

#### 2. ​**HeightField Mask by Object**​  
- 通过几何体投射生成遮罩，用于雕刻特定区域（如人工湖）[3,8](@ref)。  
- 支持反转遮罩（Invert Mask）功能[8](@ref)。

#### 3. ​**HeightField Clip**​  
- 裁剪地形范围，常用于限定湖泊/河流的最低平面高度[2,5](@ref)。  
- 通过`Min Elevation`和`Max Elevation`参数精确控制裁剪边界[5](@ref)。

---

### 四、数据转换与输出节点
#### 1. ​**Convert HeightField**​  
- 将高度场转换为多边形网格或VDB体积，支持四边形/三角形拓扑优化[2,7](@ref)。  
- 转换后可通过`PolyReduce`节点减面优化（如从800万点减至50万点）[7](@ref)。

#### 2. ​**HeightField Output**​  
- 导出高度图为位图（如EXR格式），或输出材质遮罩层（Flow、Debris等）用于渲染[2,5](@ref)。  
- 支持多通道分离存储（红/绿/蓝/Alpha通道）[8](@ref)。

---

### 五、辅助工具节点
#### 1. ​**HeightField Scatter**​  
- 根据地形的坡度、高度等属性生成离散点，用于植被或岩石分布[6,8](@ref)。  
- 支持输入自定义几何体（如树木模型）进行实例化替换[6](@ref)。

#### 2. ​**HeightField Visualize**​  
- 可视化遮罩层（如用红色表示侵蚀强度），辅助调试[2,8](@ref)。  
- 可切换显示高度场或遮罩层的颜色编码坡道[4](@ref)。

---

> ​**提示**：节点参数优化方向  
> - 侵蚀节点（Erode）优先调整`Grid Bias`控制河道方向，`Deposition Rate`影响地形细节保留程度[1,6](@ref)。  
> - 噪波节点（Noise）建议结合`Resample`节点提升分辨率（如设置Grid Spacing=0.5）[4,5](@ref)。