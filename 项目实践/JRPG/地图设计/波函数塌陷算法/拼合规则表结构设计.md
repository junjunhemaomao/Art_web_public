# 拼合规则表结构设计 (修订版)

## Sheet 1: 组件属性表 (ComponentProperties)
| 列名          | 类型      | 说明                                 |
|---------------|-----------|--------------------------------------|
| ComponentID   | string    | 组件唯一标识符 (如 S10_F, R5_N)       |
| ComponentName | string    | 组件命名 (如 S10_F, R5_N)             |
| HasNorthWall  | boolean   | 是否有北墙 (0/1)                     |
| HasEastWall   | boolean   | 是否有东墙 (0/1)                     |
| HasSouthWall  | boolean   | 是否有南墙 (0/1)                     |
| HasWestWall   | boolean   | 是否有西墙 (0/1)                     |
| Size          | string    | 尺寸类型 (S10, R5, R20)              |
| Width         | float     | 宽度                                 |
| Length        | float     | 长度                                 |
| CenterPointX  | float     | 中心点 X 坐标                        |
| CenterPointY  | float     | 中心点 Y 坐标                        |

---

## Sheet 2: 拼合规则矩阵 (ConnectionMatrix)
| 列名        | 类型      | 说明                                     |
|-------------|-----------|------------------------------------------|
| SourceID    | string    | 源组件 ID                                |
| TargetID    | string    | 目标组件 ID                              |
| Direction   | string    | 连接方向 (N/E/S/W)                       |
| IsValid     | boolean   | 是否可以连接 (0/1)                       |
| OffsetX     | float     | X 轴偏移量                               |
| OffsetY     | float     | Y 轴偏移量                               |
| Priority    | int       | 拼合优先级 (1-5)                         |

---

## Sheet 3: 连接点数据 (ConnectionPoints)
| 列名        | 类型      | 说明                                     |
|-------------|-----------|------------------------------------------|
| ComponentID | string    | 组件 ID                                  |
| Direction   | string    | 方向 (N/E/S/W)                           |
| PointX      | float     | 连接点 X 坐标                            |
| PointY      | float     | 连接点 Y 坐标                            |
| Type        | string    | 连接点类型 (Wall/Floor)                  |

---

## Sheet 4: 组件组合规则 (CombinationRules)
| 列名        | 类型      | 说明                                     |
|-------------|-----------|------------------------------------------|
| RuleID      | string    | 规则 ID                                  |
| Component1  | string    | 组件 1 ID                                |
| Component2  | string    | 组件 2 ID                                |
| Direction   | string    | 连接方向 (N/E/S/W)                       |
| IsValid     | boolean   | 是否允许 (0/1)                           |
| Notes       | string    | 规则说明                                 |

---

## 数据示例
```plaintext
// ComponentProperties 示例
S10_F, S10_F, 0, 0, 0, 0, S10, 10, 10, 0, 0
R5_N, R5_N, 1, 0, 0, 0, R5, 5, 10, 0, 0

// ConnectionMatrix 示例
S10_F, S10_N, N, 1, 0, 10, 1
R5_N, S10_E, E, 1, 10, 0, 2
